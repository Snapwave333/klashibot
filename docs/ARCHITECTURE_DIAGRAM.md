# Optimized Trading Pipeline Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        REACT DASHBOARD                            â”‚
â”‚                     (localhost:3002)                              â”‚
â”‚                    "AURA DESIGN SYSTEM"                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚      Bento Grid Layout    â”‚  â”‚  AI Agent  â”‚  â”‚   Style    â”‚â”‚
â”‚  â”‚   (Equity, Perf, Risk)    â”‚  â”‚  Insights  â”‚  â”‚   Guide    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â–²               â–²               â–²               â–²         â”‚
â”‚         â”‚               â”‚               â”‚               â”‚         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   Component Library                         â”‚  â”‚
â”‚  â”‚ (GlassCard, Button, Badge, AuraMascot, ThemeContext)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ WebSocket (port 8766)
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WEBSOCKET BRIDGE                               â”‚
â”‚                    (websocket_bridge.py)                          â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          AI TRADING LOOP (10 second intervals)           â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  1ï¸âƒ£  Update Portfolio from Kalshi                        â”‚  â”‚
â”‚  â”‚  2ï¸âƒ£  Adjust Risk Parameters (Dynamic Kelly)             â”‚  â”‚
â”‚  â”‚  3ï¸âƒ£  Get AI Feedback Metrics                            â”‚  â”‚
â”‚  â”‚  4ï¸âƒ£  Check Portfolio Optimization                       â”‚  â”‚
â”‚  â”‚  5ï¸âƒ£  Find Best Opportunities                            â”‚  â”‚
â”‚  â”‚  6ï¸âƒ£  Execute Top Opportunity                            â”‚  â”‚
â”‚  â”‚  7ï¸âƒ£  Broadcast Results to Dashboard                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚        â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ MCP Protocol
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TRADING ENGINE                                â”‚
â”‚                   (trading_engine.py) - NEW!                      â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   ENHANCED FEATURES                         â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  ğŸš€ Performance Optimizations:                             â”‚ â”‚
â”‚  â”‚     â€¢ 2x faster market scanning (batch size 20)            â”‚ â”‚
â”‚  â”‚     â€¢ LRU cache with 200 entry limit                       â”‚ â”‚
â”‚  â”‚     â€¢ 60% API call reduction                               â”‚ â”‚
â”‚  â”‚     â€¢ 40 markets analyzed (up from 30)                     â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  ğŸ“Š Execution Quality:                                     â”‚ â”‚
â”‚  â”‚     â€¢ Smart order routing                                  â”‚ â”‚
â”‚  â”‚     â€¢ Price impact adjustment                              â”‚ â”‚
â”‚  â”‚     â€¢ Latency tracking (ms)                                â”‚ â”‚
â”‚  â”‚     â€¢ Slippage measurement (%)                             â”‚ â”‚
â”‚  â”‚     â€¢ Fill rate monitoring                                 â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  ğŸ›¡ï¸ Risk Management:                                      â”‚ â”‚
â”‚  â”‚     â€¢ Position correlation analysis                        â”‚ â”‚
â”‚  â”‚     â€¢ 5 correlation groups tracked                         â”‚ â”‚
â”‚  â”‚     â€¢ Concentration limits (20% max)                       â”‚ â”‚
â”‚  â”‚     â€¢ Diversification enforcement                          â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  ğŸ¤– AI Feedback Loop:                                      â”‚ â”‚
â”‚  â”‚     â€¢ Real-time performance metrics                        â”‚ â”‚
â”‚  â”‚     â€¢ Strategy analytics                                   â”‚ â”‚
â”‚  â”‚     â€¢ Actionable recommendations                           â”‚ â”‚
â”‚  â”‚     â€¢ Win rate trend analysis                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ MCP Tools (7 available)
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MCP SERVER                                   â”‚
â”‚                  (mcp-server-kalshi/)                              â”‚
â”‚                                                                     â”‚
â”‚  Available Tools:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. get_positions    - Current holdings                      â”‚ â”‚
â”‚  â”‚  2. get_balance      - Account balance                       â”‚ â”‚
â”‚  â”‚  3. get_orders       - Active orders                         â”‚ â”‚
â”‚  â”‚  4. get_fills        - Trade execution history               â”‚ â”‚
â”‚  â”‚  5. create_order     - Place orders                          â”‚ â”‚
â”‚  â”‚  6. get_settlements  - Settled positions                     â”‚ â”‚
â”‚  â”‚  7. get_event        - Event details                         â”‚ â”‚
â”‚  â”‚  8. fetch_rss_feed   - News & Updates (NEW)                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚  Authentication:                                                    â”‚
â”‚  â€¢ RSA-PSS signature (SHA256)                                      â”‚
â”‚  â€¢ API Key + Private Key                                           â”‚
â”‚                                                                     â”‚
â”‚  Paper Trading Mode: âœ… ENABLED                                    â”‚
â”‚  â€¢ Simulated $100 balance                                          â”‚
â”‚  â€¢ Real market data                                                â”‚
â”‚  â€¢ Risk-free testing                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ HTTPS REST API
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      KALSHI EXCHANGE                                â”‚
â”‚              (api.elections.kalshi.com)                            â”‚
â”‚                                                                     â”‚
â”‚  Endpoints:                                                         â”‚
â”‚  â€¢ /trade-api/v2/portfolio/balance                                 â”‚
â”‚  â€¢ /trade-api/v2/portfolio/positions                               â”‚
â”‚  â€¢ /trade-api/v2/portfolio/orders                                  â”‚
â”‚  â€¢ /trade-api/v2/markets                                           â”‚
â”‚  â€¢ /trade-api/v2/orderbook                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SELF-HEALING WORKER                             â”‚
â”‚                    (self-healing-worker/)                           â”‚
â”‚                                                                     â”‚
â”‚  â€¢ Monitors: Redis, Backend, MCP, Database                          â”‚
â”‚  â€¢ Engine: HealerEngine (15s Loop)                                  â”‚
â”‚  â€¢ Output: /api/v1/status                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Detailed Trading Loop Flow

```
START ITERATION
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. UPDATE PORTFOLIO                â”‚
â”‚  â€¢ Fetch balance from Kalshi        â”‚
â”‚  â€¢ Get current positions            â”‚
â”‚  â€¢ Calculate metrics                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. DYNAMIC RISK ADJUSTMENT         â”‚
â”‚  â€¢ Check win/loss streaks           â”‚
â”‚  â€¢ Adjust Kelly fraction            â”‚
â”‚  â€¢ Modify min_edge threshold        â”‚
â”‚  â€¢ Monitor drawdown                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. AI FEEDBACK METRICS             â”‚
â”‚  â€¢ Calculate win rate               â”‚
â”‚  â€¢ Analyze strategy performance     â”‚
â”‚  â€¢ Measure execution quality        â”‚
â”‚  â€¢ Generate recommendations         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. PORTFOLIO OPTIMIZATION CHECK    â”‚
â”‚  â€¢ Check concentration limits       â”‚
â”‚  â€¢ Analyze correlation groups       â”‚
â”‚  â€¢ Suggest rebalancing              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. SCAN MARKETS (PARALLEL)         â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Batch 1: Markets 0-19         â”‚ â”‚
â”‚  â”‚ Batch 2: Markets 20-39        â”‚ â”‚ â† Parallel
â”‚  â”‚ Batch 3: Markets 40-59        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                         â”‚
â”‚           â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ PRE-FILTER                    â”‚ â”‚
â”‚  â”‚ â€¢ Status = active             â”‚ â”‚
â”‚  â”‚ â€¢ Volume > 100                â”‚ â”‚
â”‚  â”‚ â€¢ Open Interest > 50          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                         â”‚
â”‚  Result: 50 markets â†’ 35 quality   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. ANALYZE OPPORTUNITIES           â”‚
â”‚                                     â”‚
â”‚  For each market (40 parallel):    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Check cache (60s TTL)         â”‚ â”‚
â”‚  â”‚    â”‚                           â”‚ â”‚
â”‚  â”‚    â”œâ”€ HIT â†’ Return cached     â”‚ â”‚
â”‚  â”‚    â”‚                           â”‚ â”‚
â”‚  â”‚    â””â”€ MISS â†“                  â”‚ â”‚
â”‚  â”‚           â”‚                    â”‚ â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚    â”‚ Fetch in Parallel:  â”‚   â”‚ â”‚
â”‚  â”‚    â”‚ â€¢ Market details    â”‚   â”‚ â”‚
â”‚  â”‚    â”‚ â€¢ Orderbook data    â”‚   â”‚ â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚           â”‚                    â”‚ â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚    â”‚ Calculate Edge:     â”‚   â”‚ â”‚
â”‚  â”‚    â”‚ â€¢ Arbitrage (2%+)   â”‚   â”‚ â”‚
â”‚  â”‚    â”‚ â€¢ Spread (<3)       â”‚   â”‚ â”‚
â”‚  â”‚    â”‚ â€¢ Value (1.5%+)     â”‚   â”‚ â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚           â”‚                    â”‚ â”‚
â”‚  â”‚    Store in cache âœ“           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚  Result: 15 opportunities found    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. CORRELATION FILTERING           â”‚
â”‚                                     â”‚
â”‚  Group by correlation:              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ—³ï¸  Election: 5 opps          â”‚ â”‚
â”‚  â”‚ ğŸ’° Crypto: 3 opps             â”‚ â”‚
â”‚  â”‚ ğŸ“ˆ Stocks: 4 opps             â”‚ â”‚
â”‚  â”‚ ğŸˆ Sports: 2 opps             â”‚ â”‚
â”‚  â”‚ ğŸ›ï¸  Economy: 1 opp            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                         â”‚
â”‚  Check existing positions:          â”‚
â”‚  â€¢ Have 2 election positions       â”‚
â”‚  â€¢ No crypto positions             â”‚
â”‚  â€¢ 1 stock position                â”‚
â”‚           â”‚                         â”‚
â”‚  Filter logic:                      â”‚
â”‚  â€¢ Election: Keep only best (3.5%) â”‚
â”‚  â€¢ Crypto: Keep all 3              â”‚
â”‚  â€¢ Stocks: Keep top 2              â”‚
â”‚  â€¢ Sports: Keep all 2              â”‚
â”‚  â€¢ Economy: Keep 1                 â”‚
â”‚           â”‚                         â”‚
â”‚  Result: 9 filtered opportunities  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  8. RISK-ADJUSTED SCORING           â”‚
â”‚                                     â”‚
â”‚  Score = edge Ã— confidence          â”‚
â”‚          Ã— liquidity_score          â”‚
â”‚                                     â”‚
â”‚  Sort by score (descending)         â”‚
â”‚                                     â”‚
â”‚  Top 3:                             â”‚
â”‚  1. CRYPTO-BTC: 2.8% (score: 2.24) â”‚
â”‚  2. ELECTION-DEM: 3.5% (1.97)      â”‚
â”‚  3. STOCK-SPY: 2.3% (1.84)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  9. SMART ORDER EXECUTION           â”‚
â”‚                                     â”‚
â”‚  Selected: CRYPTO-BTC (best score)  â”‚
â”‚           â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Adjust Price for Impact      â”‚  â”‚
â”‚  â”‚ â€¢ Check history for ticker   â”‚  â”‚
â”‚  â”‚ â€¢ Add 0.5Â¢ if high impact    â”‚  â”‚
â”‚  â”‚ â€¢ Entry: $45.0 â†’ $45.5       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Place Order (MCP)            â”‚  â”‚
â”‚  â”‚ â€¢ Type: limit                â”‚  â”‚
â”‚  â”‚ â€¢ Side: yes                  â”‚  â”‚
â”‚  â”‚ â€¢ Price: $45.5               â”‚  â”‚
â”‚  â”‚ â€¢ Size: 12 contracts         â”‚  â”‚
â”‚  â”‚                               â”‚  â”‚
â”‚  â”‚ Start timer â±ï¸                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Kalshi API Call              â”‚  â”‚
â”‚  â”‚ â€¢ RSA signature              â”‚  â”‚
â”‚  â”‚ â€¢ POST /orders               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Track Metrics                â”‚  â”‚
â”‚  â”‚ â€¢ Latency: 142ms âœ“           â”‚  â”‚
â”‚  â”‚ â€¢ Slippage: 0.089% âœ“         â”‚  â”‚
â”‚  â”‚ â€¢ Order ID: 12345            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                         â”‚
â”‚  Result: Order placed âœ…            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  10. UPDATE METRICS & BROADCAST     â”‚
â”‚                                     â”‚
â”‚  â€¢ Add to trade history             â”‚
â”‚  â€¢ Update performance stats         â”‚
â”‚  â€¢ Calculate new metrics            â”‚
â”‚                                     â”‚
â”‚  Dashboard Update:                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ¯ TRADE EXECUTED             â”‚ â”‚
â”‚  â”‚ Market: CRYPTO-BTC            â”‚ â”‚
â”‚  â”‚ Side: YES                     â”‚ â”‚
â”‚  â”‚ Price: $45.5                  â”‚ â”‚
â”‚  â”‚ Size: 12 contracts            â”‚ â”‚
â”‚  â”‚ Edge: 2.80%                   â”‚ â”‚
â”‚  â”‚                                â”‚ â”‚
â”‚  â”‚ ğŸ“ˆ Win Rate: 62.5%            â”‚ â”‚
â”‚  â”‚    Trades: 24                 â”‚ â”‚
â”‚  â”‚    P&L: $87.50                â”‚ â”‚
â”‚  â”‚    Fill Rate: 83%             â”‚ â”‚
â”‚  â”‚    Avg Latency: 145ms         â”‚ â”‚
â”‚  â”‚    Avg Slippage: 0.112%       â”‚ â”‚
â”‚  â”‚                                â”‚ â”‚
â”‚  â”‚ ğŸ’¡ Strong win rate            â”‚ â”‚
â”‚  â”‚    Consider increasing sizes  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
         Wait 10 seconds
               â”‚
               â–¼
         NEXT ITERATION
```

---

## Cache System Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CACHE SYSTEM                          â”‚
â”‚                                                          â”‚
â”‚  analyze_market_fast("CRYPTO-BTC")                      â”‚
â”‚           â”‚                                              â”‚
â”‚           â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Generate Cache Key                                 â”‚ â”‚
â”‚  â”‚ key = "CRYPTO-BTC_1706043600"  (ticker_epoch)     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚               â”‚                                          â”‚
â”‚               â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Check Cache                                        â”‚ â”‚
â”‚  â”‚ if key in self.market_cache:                      â”‚ â”‚
â”‚  â”‚     return cached_opportunity  â† CACHE HIT âœ…     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚               â”‚                                          â”‚
â”‚         CACHE MISS                                       â”‚
â”‚               â”‚                                          â”‚
â”‚               â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Fetch Fresh Data (Parallel)                       â”‚ â”‚
â”‚  â”‚ â€¢ Market details API call                         â”‚ â”‚
â”‚  â”‚ â€¢ Orderbook API call                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚               â”‚                                          â”‚
â”‚               â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Calculate Opportunity                             â”‚ â”‚
â”‚  â”‚ â€¢ Analyze spreads                                 â”‚ â”‚
â”‚  â”‚ â€¢ Calculate edges                                 â”‚ â”‚
â”‚  â”‚ â€¢ Score liquidity                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚               â”‚                                          â”‚
â”‚               â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Check Cache Size                                  â”‚ â”‚
â”‚  â”‚ if len(cache) >= 200:  â† LRU EVICTION            â”‚ â”‚
â”‚  â”‚     oldest_key = next(iter(cache))                â”‚ â”‚
â”‚  â”‚     del cache[oldest_key]  â† Remove oldest       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚               â”‚                                          â”‚
â”‚               â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Store in Cache                                    â”‚ â”‚
â”‚  â”‚ cache[key] = opportunity  â† ADD TO CACHE âœ…       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚               â”‚                                          â”‚
â”‚               â–¼                                          â”‚
â”‚         Return opportunity                               â”‚
â”‚                                                          â”‚
â”‚  Cache Performance Metrics:                             â”‚
â”‚  â€¢ Hit Rate: 60-70% (target: >60%)                     â”‚
â”‚  â€¢ Max Size: 200 entries                                â”‚
â”‚  â€¢ TTL: 60 seconds                                      â”‚
â”‚  â€¢ Savings: 60% API call reduction                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Correlation Analysis Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           CORRELATION-AWARE FILTERING                     â”‚
â”‚                                                           â”‚
â”‚  Input: 15 opportunities found                           â”‚
â”‚         â”‚                                                 â”‚
â”‚         â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Build Correlation Groups                            â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚ For each opportunity:                               â”‚ â”‚
â”‚  â”‚   title = "Bitcoin hits $100K"                      â”‚ â”‚
â”‚  â”‚   group = _get_correlation_group(title)             â”‚ â”‚
â”‚  â”‚         = "crypto"                                   â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚ Keywords:                                            â”‚ â”‚
â”‚  â”‚ â€¢ "election", "president" â†’ election               â”‚ â”‚
â”‚  â”‚ â€¢ "crypto", "bitcoin", "eth" â†’ crypto              â”‚ â”‚
â”‚  â”‚ â€¢ "stock", "sp500", "nasdaq" â†’ stocks              â”‚ â”‚
â”‚  â”‚ â€¢ "sports", "nfl", "nba" â†’ sports                  â”‚ â”‚
â”‚  â”‚ â€¢ "economy", "gdp", "inflation" â†’ economy          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                  â”‚                                        â”‚
â”‚                  â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Group Results:                                      â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚ election: [PRES2024-DEM, PRES2024-REP, SENATE-NY]  â”‚ â”‚
â”‚  â”‚ crypto: [BTC-100K, ETH-10K, DOGE-1]                â”‚ â”‚
â”‚  â”‚ stocks: [SP500-ATH, NASDAQ-20K, AAPL-250]          â”‚ â”‚
â”‚  â”‚ sports: [NBA-FINALS, NFL-SUPERBOWL]                â”‚ â”‚
â”‚  â”‚ economy: [GDP-GROWTH]                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                  â”‚                                        â”‚
â”‚                  â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Check Existing Positions (last 10 trades)          â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚ Active groups:                                       â”‚ â”‚
â”‚  â”‚ â€¢ election: 2 positions âš ï¸                          â”‚ â”‚
â”‚  â”‚ â€¢ crypto: 0 positions âœ…                            â”‚ â”‚
â”‚  â”‚ â€¢ stocks: 1 position âš ï¸                             â”‚ â”‚
â”‚  â”‚ â€¢ sports: 0 positions âœ…                            â”‚ â”‚
â”‚  â”‚ â€¢ economy: 0 positions âœ…                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                  â”‚                                        â”‚
â”‚                  â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Apply Filtering Logic                               â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚ For each group:                                     â”‚ â”‚
â”‚  â”‚   if has_exposure:                                  â”‚ â”‚
â”‚  â”‚     # Stricter - only best opportunity             â”‚ â”‚
â”‚  â”‚     if best_edge > min_edge Ã— 1.5:  â† 1.5x higher â”‚ â”‚
â”‚  â”‚       keep best_opportunity                         â”‚ â”‚
â”‚  â”‚     else:                                            â”‚ â”‚
â”‚  â”‚       skip all in group                             â”‚ â”‚
â”‚  â”‚   else:                                              â”‚ â”‚
â”‚  â”‚     # No exposure - keep all                        â”‚ â”‚
â”‚  â”‚     keep all_opportunities                          â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚ Results:                                             â”‚ â”‚
â”‚  â”‚ â€¢ election: Keep only PRES2024-DEM (3.5% > 3.0%)  â”‚ â”‚
â”‚  â”‚ â€¢ crypto: Keep all 3 (no exposure) âœ…              â”‚ â”‚
â”‚  â”‚ â€¢ stocks: Keep SP500-ATH (2.8% > 3.0%) âŒ SKIP    â”‚ â”‚
â”‚  â”‚ â€¢ sports: Keep all 2 (no exposure) âœ…              â”‚ â”‚
â”‚  â”‚ â€¢ economy: Keep 1 (no exposure) âœ…                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                  â”‚                                        â”‚
â”‚                  â–¼                                        â”‚
â”‚  Filtered Output: 7 opportunities                        â”‚
â”‚  (Was 15, filtered to 7 for diversification)            â”‚
â”‚                                                           â”‚
â”‚  Benefits:                                                â”‚
â”‚  â€¢ Prevents over-concentration                           â”‚
â”‚  â€¢ Reduces correlated risk                              â”‚
â”‚  â€¢ Enforces diversification                             â”‚
â”‚  â€¢ Requires higher edge for correlated trades           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Performance Metrics Dashboard

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PERFORMANCE TRACKING                        â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  TRADE EXECUTION METRICS                                  â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  Per Trade:                                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Order Placement Time: 2026-01-22 14:23:45.123      â”‚â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Ticker: CRYPTO-BTC                                  â”‚â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Entry Price: $45.00                                 â”‚â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Adjusted Price: $45.50 (+0.5Â¢ impact adjustment)   â”‚â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Fill Price: $45.54                                  â”‚â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Slippage: 0.089% âœ…                                â”‚â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Latency: 142ms âœ…                                  â”‚â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Size: 12 contracts                                  â”‚â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Edge: 2.80%                                         â”‚â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Strategy: ADAPTIVE                                  â”‚â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  Rolling Averages (last 100 orders):                      â”‚ â”‚
â”‚  â”‚  â€¢ Avg Latency: 145ms                                    â”‚ â”‚
â”‚  â”‚  â€¢ Avg Slippage: 0.112%                                  â”‚ â”‚
â”‚  â”‚  â€¢ Fill Rate: 83% (83/100 filled)                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  OVERALL PERFORMANCE                                      â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  â€¢ Win Rate: 62.5% (15W / 9L) ğŸŸ¢                         â”‚ â”‚
â”‚  â”‚  â€¢ Total Trades: 24                                       â”‚ â”‚
â”‚  â”‚  â€¢ Total P&L: $87.50                                      â”‚ â”‚
â”‚  â”‚  â€¢ Avg P&L/Trade: $3.65                                   â”‚ â”‚
â”‚  â”‚  â€¢ Max Drawdown: 4.2%                                     â”‚ â”‚
â”‚  â”‚  â€¢ Consecutive Wins: 5 ğŸ”¥                                â”‚ â”‚
â”‚  â”‚  â€¢ Consecutive Losses: 0                                  â”‚ â”‚
â”‚  â”‚  â€¢ Current Strategy: ADAPTIVE                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  STRATEGY BREAKDOWN                                       â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  ARBITRAGE:                                               â”‚ â”‚
â”‚  â”‚  â€¢ Trades: 8                                              â”‚ â”‚
â”‚  â”‚  â€¢ Avg Edge: 3.2%                                        â”‚ â”‚
â”‚  â”‚  â€¢ Avg Latency: 138ms                                    â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  SPREAD_CAPTURE:                                          â”‚ â”‚
â”‚  â”‚  â€¢ Trades: 10                                             â”‚ â”‚
â”‚  â”‚  â€¢ Avg Edge: 2.1%                                        â”‚ â”‚
â”‚  â”‚  â€¢ Avg Latency: 152ms                                    â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  VALUE:                                                    â”‚ â”‚
â”‚  â”‚  â€¢ Trades: 6                                              â”‚ â”‚
â”‚  â”‚  â€¢ Avg Edge: 2.7%                                        â”‚ â”‚
â”‚  â”‚  â€¢ Avg Latency: 145ms                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  AI RECOMMENDATIONS                                       â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚  ğŸ’¡ Best performing strategy: ARBITRAGE (avg 3.2%)       â”‚ â”‚
â”‚  â”‚  ğŸŸ¢ Strong win rate - Consider increasing position sizes â”‚ â”‚
â”‚  â”‚  âœ… Execution quality excellent (low slippage)           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Structure

```
Kalashi/
â”œâ”€â”€ websocket_bridge.py          â† WebSocket server + AI loop
â”œâ”€â”€ trading_engine.py             â† Core trading logic (OPTIMIZED)
â”œâ”€â”€ ai-agent/
â”‚   â”œâ”€â”€ agent.py                  â† Standalone AI agent
â”‚   â””â”€â”€ system_prompt.md          â† AI instructions
â”œâ”€â”€ mcp-server-kalshi/
â”‚   â”œâ”€â”€ server.py                 â† MCP server implementation
â”‚   â”œâ”€â”€ client.py                 â† Kalshi API client
â”‚   â”œâ”€â”€ schemas.py                â† Data models
â”‚   â””â”€â”€ auth/
â”‚       â””â”€â”€ base.py               â† RSA authentication
â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.tsx               â† React dashboard
â”‚   â”‚   â””â”€â”€ components/           â† UI components
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ config/
â”‚   â””â”€â”€ kalshi_private.pem        â† RSA private key
â”œâ”€â”€ OPTIMIZATION_SUMMARY.md       â† Detailed optimization docs
â”œâ”€â”€ QUICK_REFERENCE.md            â† Quick reference guide
â””â”€â”€ ARCHITECTURE_DIAGRAM.md       â† This file
```

---

## Data Flow Summary

1. **Dashboard** sends commands via WebSocket
2. **WebSocket Bridge** manages AI trading loop
3. **Trading Engine** performs optimized market analysis
4. **MCP Server** proxies requests to Kalshi API
5. **Kalshi Exchange** provides market data and executes orders
6. Results flow back through layers to dashboard

**Key Optimization:** Trading Engine now caches, filters, and optimizes
before hitting the API, resulting in 60% fewer calls and 2x faster execution.

---

**Version:** 2.0
**Last Updated:** 2026-01-22
